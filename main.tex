%!TeX spellcheck = en-US

\RequirePackage{pdf14}
\documentclass[a4paper,11pt,twoside,openright]{thesis}
%\pdfminorversion=7

\usepackage{url}
\usepackage{amsmath}
\usepackage{color, graphicx, setspace}
\usepackage{subfigure}
\usepackage{amsmath, amsfonts}
\usepackage{lscape}
\usepackage{longtable}
\usepackage{quotchap}
\usepackage{csquotes}
\usepackage{tikz}
\usepackage{booktabs}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{calc}
\usetikzlibrary{fit,positioning}

\usepackage{algorithm}
\usepackage{algpseudocode}
%this is to fix nested function calls
\renewcommand*\Call[2]{\textproc{#1}(#2)}

\usepackage{colortbl}
\usepackage{xcolor}
\definecolor{pathwaynode}{RGB}{255,150,50}
\definecolor{independentnode}{RGB}{255,255,50}
\newcommand{\boz}{\cellcolor{pathwaynode}}
\newcommand{\ghool}{\cellcolor{independentnode}}


%\pdfoptionpdfminorversion 7
%\pdfpageattr {/Group << /S /Transparency /I true /CS /DeviceRGB>>}


\begin{document}
\frontmatter

\title{Interpretable Methods in Cancer Diagnostics}
\author{Adrin Jalali Khooshahr}
\date{2020}
\maketitle
%%% Information
\newpage{%
\null
\thispagestyle{empty}%
\begin{flushright}
\null
\begin{table}[b!]
  \centering
  \begin{tabular}[b]{l|l}
    \textbf{Day of colloquium}         & \\%20.12.2019\\[1.1em]
    \textbf{Dean of the faculty}       & \\%Univ.-Professor Dr. Sebastian Hack\\[1.1em]
    \\
    \textbf{Chair of the committee}    & \\%Prof.~Dr. Volkhard Helms\\[1.1em]
    \textbf{Reporters} & \\
    \textbf{First Reviewer}            & \\%Prof.~Dr.~Nico Pfeifer\\%[1.1em]
    \textbf{Second Reviewer}           & \\%Prof.~Dr.~Olga Kalinina\\%[1.1em]
    \textbf{External Reviewer}         & \\%Dr. Ryan Brinkman\\
    \textbf{Academic assistant}        & \\%Dr.~
  \end{tabular}
\end{table}
\null
\end{flushright}
\newpage}
\newpage{%
\null
\thispagestyle{empty}%
\newpage}
%%% Dedication
\newpage{%
\null
\thispagestyle{empty}%
\begin{flushright}
\null\vspace{\stretch{3}} 
\textit{To Aleks}
\vspace{\stretch{5}}\null
\end{flushright}
\newpage}
\newpage{%
\null
\thispagestyle{empty}%
\newpage}
% Adjust page numbers
\addtocounter{page}{-6}%

\chapter*{Acknowledgment}
This thesis would not have been possible without the help and support of many
individuals, collaborators, and my supervisors. I deeply appreciate their help
and acknowledge I would not have been able to finish this work without their
help.

First and foremost, I am grateful of the support I received from my supervisors
Prof. Dr. Nico Pfeifer and Prof. Dr. Dr. Thomas Lengauer at the Max Planck
Institute for Informatics in Saarbr\"ucken, Germany, and Dr. Ryan Brinkman at
the Terry Fox Labs in the British Columbia Cancer Research Center in Vancouver,
Canada. I also would like to thank Dr. MD. Andrew Weng in the same lab.

I am also extremely thankful of my partner Aleksandra Piwowarek and my parents
who have been very supportive and encouraging during the hard times and never
gave up on being encouraging. I would not have finished this thesis without
their continuous support.

I would like to extend this acknowledgment to my colleagues with whom I have
worked and collaborated, and who have supported me with all the brainstorming
and discussions we have had. The list is long, but I would like to mention
Sarvesh Nikumbh, Nora Speicher, Anna Feldmann, Nima Aghaeepour, and Kieran
O'Neil.

The last, but not least, is to acknowledge the support I have received from my
friends from all around the world. I would like to mention Marjan Farahbod,
Iran Mansoori, Matti Lyra, Hassan Hatefi, Faraz Makari, Rob McGee, and Cyrus
Altschuck.

\begin{abstract}
Cancer is a hard problem. It is hard for the patients, for the doctors and
nurses, and for the researchers working on understanding the disease and
finding better treatments for it. The challenges faced by a pathologist
diagnosing the disease for a patient is not necessarily the same as the ones
faced by cell biologists working on experimental treatments and understanding
the fundamentals of cancer. In this thesis we work on different challenges
faced by both of the above teams.

This thesis first presents methods to improve the analysis of the flow
cytometry data used frequently in the diagnosis process, specifically for the
two subtypes of non-Hodgkin Lymphoma which are our focus: Follicular Lymphoma
and Diffuse Large B Cell Lymphoma. With a combination of concepts from graph
theory, dynamic programming, and machine learning, we present methods to
improve the diagnosis process and the analysis of the abovementioned data. The
interpretability of the method helps a pathologist to better understand a
patient's disease, which itself improves their choices for a treatment.

In the second part, we focus on the analysis of DNA-methylation and gene
expression data, both of which presenting the challenge of being very high
dimensional yet with a few number of samples comparatively. We present an
ensemble model which adapts to different patterns seen in each given data, in
order to adapt to noise and batch effects. At the same time, the
interpretability of our model helps a pathologist to better find and tune the
treatment for the patient: a step further towards personalized medicine.
\end{abstract}

\selectlanguage{ngerman}%
\begin{abstract}
Krebs ist ein schweres Problem. Es ist schwer für die Patienten, für die Ärzte
und Krankenschwestern und für die Forscher, die daran arbeiten, die Krankheit
zu verstehen und eine bessere Behandlung dafür zu finden. Die
Herausforderungen, mit denen ein Pathologe konfrontiert ist, um die Krankheit
eines Patienten zu diagnostizieren, müssen nicht die gleichen sein, mit denen
Zellbiologen konfrontiert sind, die an experimentellen Behandlungen arbeiten
und die Grundlagen von Krebs verstehen. In dieser Arbeit beschäftigen wir uns
mit verschiedenen Herausforderungen, denen sich beide oben genannten Teams
stellen.

In dieser Arbeit werden zunächst Methoden vorgestellt, um die Analyse der im
Diagnoseverfahren häufig verwendeten Durchflusszytometriedaten zu verbessern,
insbesondere für die beiden Subtypen des Non-Hodgkin-Lymphoms, auf die wir uns
konzentrieren: das follikuläre Lymphom und das diffuse großzellige
B-Zell-Lymphom. Mit einer Kombination von Konzepten aus Graphentheorie,
dynamischer Programmierung und maschinellem Lernen präsentieren wir Methoden
zur Verbesserung des Diagnoseprozesses und der Analyse der oben genannten
Daten. Die Interpretierbarkeit der Methode hilft einem Pathologen, die
Apatientenkrankheit besser zu verstehen, was wiederum seine Wahlmöglichkeiten
für eine Behandlung verbessert.

Im zweiten Teil konzentrieren wir uns auf die Analyse von DNA-Methylierungs-
und Genexpressionsdaten, die beide die Herausforderung darstellen, sehr
hochdimensional zu sein, jedoch mit nur wenigen Proben im Vergleich. Wir
präsentieren ein Zusammenstellungsmodell, das sich an unterschiedliche Muster
anpasst, die in den jeweiligen Daten zu sehen sind, um sich an Rauschen und
Batch-Effekte anzupassen. Gleichzeitig hilft die Interpretierbarkeit unseres
Modells einem Pathologen, die Behandlung für den Patienten besser zu finden und
abzustimmen: ein Schritt weiter in Richtung personalisierter Medizin.
\end{abstract}
\selectlanguage{english}%

\tableofcontents

\mainmatter

\include{introduction}

\include{background}

\include{fcs}

\include{adaptivelearning}

\include{conclusion}

\backmatter
\appendix
\chapter{RchyOptimyx Appendix}
\include{rchy-appendix}

%\chapter{Last note}

\listoftables
\listoffigures

\bibliographystyle{abbrv}
\bibliography{thesis}

\end{document}
